<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chi tiết sản phẩm</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Abel&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" th:href="@{/css/reset.css}" />
    <link rel="stylesheet" th:href="@{/css/user.css}" />
    <link rel="stylesheet" th:href="@{/css/detailProduct.css}" />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="banner">
        <p>Miễn phí vận chuyển cho mọi đơn hàng</p>
      </div>
      <nav class="navbar">
        <!-- logo -->
        <a th:href="@{/user/homePage}" title="Trang chủ"
          ><img th:src="@{/img/Logo.svg}" alt="Modimal"
        /></a>

        <!-- Navigation -->

        <ul class="nav-products">
          <li title="Áo"><a th:href="@{/user/showProduct(categoryName='Áo')}">Áo</a></li>
          <li title="Quần"><a th:href="@{/user/showProduct(categoryName='Quần')}">Quần</a></li>
          <li title="Đầm"><a th:href="@{/user/showProduct(categoryName='Đầm')}">Đầm</a></li>
          <li title="Chân váy"><a th:href="@{/user/showProduct(categoryName='Chân váy')}">Chân váy</a></li>
          <li title="Phụ kiện"><a th:href="@{/user/showProduct(categoryName='Phụ kiện')}">Phụ kiện</a></li>
        </ul>

        <!-- Action -->
       <div class="actions">
          <div class="search-box">
            <a href="javascript:void(0)" onclick="toggleSearch()">
              <img th:src="@{/img/Search_light.svg}" alt="Search-icon" />
            </a>
          </div>

         <div class="account"> 
            <a th:href="@{/account/login}" class="account_icon">
              <img th:src="@{/img/Header profile icon.svg}" alt="Account" />
            </a>
            <th:block th:if="${session.currentUser != null}">
              <div class="account_infor">
                <span th:text="${session.currentUser.name}"></span>
                <span>
                  <a th:href="@{/user/purchase}">Đơn Mua</a>
                </span>
                <span>
                  <a th:href="@{/account/logout}">Đăng Xuất</a>
                </span>
              </div>
            </th:block>
          </div>
          <div class="cart">
            <a th:href="@{/user/cart}">
              <img th:src="@{/img/Header bag icon.svg}" alt="Cart" />
            </a>
          </div>
        </div>
      </nav>

      <!-- SEARCH BAR SLIDE DOWN -->
      <div
        class="search-slide"
        id="searchSlide"
        title="Nhấn Enter để tìm kiếm."
      >
        <div class="search-inner">
          <form action="#" class="search-form" title="Nhấn Enter để tìm kiếm.">
            <button type="submit" class="search-btn">
              <img src="/static/img/Search_light.svg" alt="search" />
            </button>

            <input
              type="text"
              placeholder="Tìm kiếm"
              title="Nhấn Enter để tìm kiếm."
            />
          </form>

          <span class="close-search" onclick="toggleSearch()">✕</span>
        </div>
      </div>
    </header>

    <!-- Chi tiet san pham -->
    <main class="product-detail">
      <!-- Breadcrumb -->
      <div class="breadcrumb">
        <a th:href="@{/user/homePage}">Trang Chủ</a>
        <span>/</span>
        <th:block th:if="${p.category != null}">
          <a th:href="@{/user/showProduct(categoryName=${p.category.name})}"
             th:text="${p.category.name}"   
          >Chi Tiết Sản Phẩm</a>
        </th:block>
        <span>/</span>
        <strong class="active" th:text="${p.name}" ></strong>
      </div>

      <div class="product-wrapper">
        <!-- Gallery -->
        <div class="product-gallery">
    
          <div class="thumbs">
              <th:block th:if="${not #lists.isEmpty(p.images)}">
                  <img th:each="img, iter : ${p.images}" 
                      th:src="${img.imageUrl}" 
                      class="thumb" 
                      th:classappend="${iter.index == 0 ? 'active' : ''}"
                      onclick="changeImage(this)"
                      style="cursor: pointer; object-fit: cover;">
              </th:block>

              <img th:if="${#lists.isEmpty(p.images)}" 
                  src="/img/no-image.png" class="thumb active">
          </div>

          <div class="main-image">
              <img id="mainProductImage"
                  th:src="${not #lists.isEmpty(p.images) ? p.images[0].imageUrl : '/img/no-image.png'}" 
                  style="width: 100%; height: auto; object-fit: contain;" />
          </div>
        </div>

        <!-- Info -->
        
          <div class="product-info">
            <form th:action="@{/user/cart/add}" method="POST">
              <h1 th:text="${p.name}"></h1>
    
              
              
              <div class="price">Giá:<p class="price" th:text="${#numbers.formatDecimal(p.price, 0, 'POINT',0 , 'POINT')} + 'VNĐ'"></p></div>
    
              <!-- Quantity -->
              <div class="quantity">
                <button type="button" class="qty-btn minus">-</button>
                <input type="number" class="qty-input"  name="quantity" value="1" min="1" readonly />
                <button type="button" class="qty-btn plus" >+</button>
              </div>
    
              <div class="status">Trạng Thái:<p  th:text="${(p.status == true) ? 'Còn Hàng' : 'Hết Hàng'}"> </p></div>          

              <!-- Size -->
              <select class="size-select" name="variantId" required>
                <option value="" disabled selected>Kích Thước</option>
                <th:block th:each="v :${p.variants}">
                  <option th:value="${v.id}"
                          th:text="${v.size}"
                          th:if="${v.stock > 0}">
                  </option>

                </th:block>
              </select>
    
              <!-- Add cart -->
              <button class="add-cart" type="submit">Thêm Vào Giỏ Hàng</button>
    
              <div class="policy">
                <img th:src="@{/img/local_shipping.svg}" />
                <span>Dễ Dàng Hoàn Trả</span>
              </div>
            </form>
          </div>
        
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-container">
        <!-- Column 1 -->
        <div class="footer-col">
          <h4>Tham Gia CLB – Giảm 15% Dịp Sinh Nhật</h4>

          <div class="footer-subscribe">
            <input type="email" placeholder="Nhập Email Của Bạn" />
            <span>→</span>
          </div>

          <label class="footer-checkbox">
            <input type="checkbox" />
            Gửi email đồng nghĩa với việc đồng ý nhận thông tin từ Modimal
          </label>

          <div class="footer-social">
            <img th:src=@{/img/instagram.svg/} alt="Instagram" />
            <img th:src=@{/img/fb.svg} alt="Facebook" />
            <img th:src=@{/img/pinterest.svg} alt="Pinterest" />
            <img th:src=@{/img/tiktok.svg} alt="TikTok" />
          </div>
        </div>

        <!-- Column 2 -->
        <div class="footer-col">
          <h4>Về Modimal</h4>
          <ul>
            <li><a href="#">Bộ Sưu Tập</a></li>
            <li><a href="#">Bền Vững</a></li>
            <li><a href="#">Chính Sách Bảo Mật</a></li>
            <li><a href="#">Hệ Thống Hỗ Trợ</a></li>
            <li><a href="#">Điều Khoản & Điều Kiện</a></li>
            <li><a href="#">Bản Quyền</a></li>
          </ul>
        </div>

        <!-- Column 3 -->
        <div class="footer-col">
          <h4>Hỗ Trợ</h4>
          <ul>
            <li><a href="#">Đơn & Vận Chuyển</a></li>
            <li><a href="#">Đổi & Hoàn Tiền</a></li>
            <li><a href="#">Câu Hỏi Thường Gặp</a></li>
            <li><a href="#">Liên Hệ</a></li>
          </ul>
        </div>

        <!-- Column 4 -->
        <div class="footer-col">
          <h4>Tham Gia</h4>
          <ul>
            <li><a href="#">CLB Modimal</a></li>
            <li><a href="#">Tuyển Dụng</a></li>
            <li><a href="#">Cửa Hàng</a></li>
          </ul>
        </div>
      </div>

      <div class="footer-bottom">
        <p>© 2023 Modimal. Đã Có Bản Quyền.</p>

        <!-- Chat icon -->
        <div class="chat-icon" onclick="toggleChat()">
          <img th:src="@{/img/Footer Chat box.png}" alt="Chat" />
        </div>

        <!-- Chat modal -->
        <div class="chat-modal" id="chatModal">
          <div class="chat-header">
            <span>Hỗ trợ Modimal</span>
            <button onclick="toggleChat()">✕</button>
          </div>

          <div class="chat-body">
            <div class="chat-message bot">
              Xin chào! Modimal có thể hỗ trợ gì cho bạn?
            </div>
          </div>

          <div class="chat-input">
            <input type="text" placeholder="Nhập tin nhắn..." />
            <button>➤</button>
          </div>
        </div>
      </div>
    </footer>

    <script>
      const thumbs = document.querySelectorAll(".thumb");
      const mainImage = document.getElementById("mainProductImage");

      thumbs.forEach((thumb) => {
        thumb.addEventListener("click", () => {
          // đổi ảnh lớn
          mainImage.src = thumb.src;

          // bỏ active cũ
          thumbs.forEach((t) => t.classList.remove("active"));

          // thêm active mới
          thumb.classList.add("active");
        });
      });
    </script>

    <script th:src="@{/js/quantity.js}"></script>
  </body>
</html>
